<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Cronally API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="cronally-api-beta">Cronally API Beta</h1>

<p>The Cronally API supports account creation and management of scheduled jobs via a JSON REST-like interface.</p>

<p>A CLI is available for those who do not need direct access to the API.</p>

<aside class="warning">
Help keep your account secure &ndash; create a separate IAM user for use with Cronally and limit that user&rsquo;s privileges to publishing to a specific SNS topic.

In addition, *always* use our https:// endpoint when making requests. While we&rsquo;ll automatically redirect non-HTTPS requests to HTTPS, any requests that include confidential data (like an IAM user&rsquo;s secret access key) are vulnerable unless you begin the URL with https://.
</aside>

<h1 id="authentication">Authentication</h1>

<p>The Cronally API uses signed requests to authenticate for all actions except account creation. Please create an account before attempting to make other API calls.</p>

<p>Cronally expects the following HTTP headers to be included with each request:</p>

<p><code class="prettyprint">X-Cron-Key: [API KEY]</code></p>

<p><code class="prettyprint">X-Cron-Date: [DATE_TIME]</code></p>

<p><code class="prettyprint">X-Cron-Signature: [SIGNATURE]</code></p>

<h3 id="time-format">Time format</h3>

<p><code class="prettyprint">[DATE_TIME]</code> is the current UTC time formatted as <code class="prettyprint">%Y%m%d%H%M</code> (24-hour clock)</p>

<p>Example: <code class="prettyprint">200601021504</code></p>

<h3 id="signature-calculation">Signature calculation</h3>

<p><code class="prettyprint">[SIGNATURE]</code> is calculated as follows:</p>

<ol>
<li><p>Create <code class="prettyprint">STRING_TO_SIGN</code>:</p>

<p>Concatenate <code class="prettyprint">URL_PATH+HTTP_METHOD+DATE_TIME</code></p>

<p>Example: <code class="prettyprint">/account/GET200601021504</code></p></li>
<li><p>Create <code class="prettyprint">SIGNATURE</code>:</p>

<p>Calculate an HMAC_256 of <code class="prettyprint">STRING_TO_SIGN</code> using the base64-decoded <code class="prettyprint">API_SECRET</code>:</p>

<p><code class="prettyprint">hmac_256(base64_decode(API_SECRET), STRING_TO_SIGN)</code></p>

<p>Base64-encode the result to create the signature:</p>

<p><code class="prettyprint">base64_encode(HMAC_256)</code></p></li>
<li><p>Add <code class="prettyprint">X-Cron-Signature</code> HTTP header to the request containing the encoded HMAC</p></li>
</ol>

<aside class="notice">
You must replace <code>[API KEY]</code>, <code>[DATE_TIME]</code>, and <code>[SIGNATURE]</code> with your API Key, current date/time, and calculated HMAC signature, respectively.
</aside>

<h1 id="account">Account</h1>

<h2 id="create-account">Create Account</h2>
<pre class="highlight shell"><code>curl -X POST -d <span class="nv">email</span><span class="o">=</span>username@example.com https://api.cronally.com/account/
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34f10c9d-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"username@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"59ab5a9c-ce44-4446-9501-76f4f64be3c6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"api_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"h/Be+K0LvQxanvcabBL5Pjg3HL8g7CekNkG090he6rk="</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint creates a Cronally account.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.cronally.com/account/</code></p>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>true</td>
<td>The email address to associate with the account. Must be unique.</td>
</tr>
</tbody></table>

<h3 id="http-response">HTTP Response</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
<tr>
<td>Account ID</td>
<td>Account ID of newly created account</td>
</tr>
<tr>
<td>Email</td>
<td>Email address associated with newly created account</td>
</tr>
<tr>
<td>API Key</td>
<td>API key for newly created account</td>
</tr>
<tr>
<td>API Secret</td>
<td>Secret used to calculate signature for API requests</td>
</tr>
<tr>
<td>Cronjob Count</td>
<td>Total number of cron jobs associated with account</td>
</tr>
</tbody></table>

<h2 id="get-account-info">Get Account Info</h2>
<pre class="highlight shell"><code>curl -X GET https://api.cronally.com/account/
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34f10c9d-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"username@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"59ab5a9c-ce44-4446-9501-76f4f64be3c6"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"api_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"h/Be+K0LvQxanvcabBL5Pjg3HL8g7CekNkG090he6rk="</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves information for the account associated with the API key</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.cronally.com/account/</code></p>

<h3 id="http-response">HTTP Response</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
<tr>
<td>Account ID</td>
<td>Account ID of newly created account</td>
</tr>
<tr>
<td>Email</td>
<td>Email address associated with newly created account</td>
</tr>
<tr>
<td>API Key</td>
<td>API key for newly created account</td>
</tr>
<tr>
<td>API Secret</td>
<td>Secret used to calculate signature for API requests</td>
</tr>
<tr>
<td>Cronjob Count</td>
<td>Total number of cron jobs associated with account</td>
</tr>
</tbody></table>

<h2 id="add-cron-job">Add cron job</h2>
<pre class="highlight shell"><code>curl -X POST <span class="se">\</span>
-d <span class="s2">"name=cronjob"</span> <span class="se">\</span>
-d <span class="s2">"cron=0 * * * *"</span> <span class="se">\ </span>
-d <span class="s2">"sns_topic=arn:aws:sns:us-east-1:625900001012331:cron"</span> <span class="se">\ </span>
-d <span class="s2">"sns_message=hello from cronally"</span> <span class="se">\ </span>
-d <span class="s2">"sns_region=us-east-1"</span> <span class="se">\ </span>
-d <span class="s2">"sns_access_key_id=AKIAIOBAKZ88ALIMQPKBC3Q"</span> <span class="se">\ </span>
-d <span class="s2">"sns_secret_access_key=KdDja8..."</span> <span class="se">\ </span>
https://api.cronally.com/cronjob/
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34f10c9d-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"37e545bd-fc2d-43e4-9b4a-e5eb4bc1f54e"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cronjob"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0 * * * *"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint creates a new cron job</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST https://api.cronally.com/cronjob/</code></p>

<aside class="warning">
This request requires the secret access key for an IAM user. *always* use our https:// endpoint when making this request to avoid exposing that user&rsquo;s secret key!
</aside>

<h3 id="parameters">Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>true</td>
<td>Name of the cron job to create.</td>
</tr>
<tr>
<td>cron</td>
<td>true</td>
<td>When to run the cron job in cron format (ex: <code class="prettyprint">0 8 * * *</code>)</td>
</tr>
<tr>
<td>sns_topic</td>
<td>true</td>
<td>AWS SNS topic to associate with cron job</td>
</tr>
<tr>
<td>sns_message</td>
<td>true</td>
<td>Message to publish on SNS topic (if not needed, provide any string value)</td>
</tr>
<tr>
<td>sns_region</td>
<td>true</td>
<td>AWS region for SNS endpoint (ex: <code class="prettyprint">us-east-1</code>)</td>
</tr>
<tr>
<td>sns_access_key_id</td>
<td>true</td>
<td>AWS IAM access key ID with appropriate permissions to publish on SNS topic</td>
</tr>
<tr>
<td>sns_secret_access_key</td>
<td>true</td>
<td>AWS IAM secret access key associated with IAM user</td>
</tr>
</tbody></table>

<h3 id="http-response">HTTP Response</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
<tr>
<td>Name</td>
<td>Name of the cron job</td>
</tr>
<tr>
<td>Cron</td>
<td>Cron-formatted string</td>
</tr>
<tr>
<td>Cronjob ID</td>
<td>ID of the newly created cron job</td>
</tr>
<tr>
<td>Account ID</td>
<td>Account ID of newly created cron job</td>
</tr>
<tr>
<td>Deleted</td>
<td>Deleted status</td>
</tr>
</tbody></table>

<h2 id="list-cron-jobs">List cron jobs</h2>
<pre class="highlight shell"><code>curl -X GET https://api.cronally.com/cronjobs/
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34f10c9d-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"37e545bd-fc2d-43e4-9b4a-e5eb4bc1f54e"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cronjob"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0 * * * *"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"da1c2aa1-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fc2d54e3-fc2d-43e4-9b4a-e5eb4bc1f54e"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cronjob 2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5 * * * *"</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint lists all cron jobs for an account</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.cronally.com/cronjobs/</code></p>

<h3 id="http-response">HTTP Response</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
<tr>
<td>Response</td>
<td>List of cron jobs associate with account</td>
</tr>
</tbody></table>

<h3 id="cron-job">Cron job</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
<tr>
<td>Name</td>
<td>Name of the cron job</td>
</tr>
<tr>
<td>Cron</td>
<td>Cron-formatted string</td>
</tr>
<tr>
<td>Cronjob ID</td>
<td>ID of the newly created cron job</td>
</tr>
<tr>
<td>Account ID</td>
<td>Account ID of newly created cron job</td>
</tr>
<tr>
<td>Deleted</td>
<td>Deleted status</td>
</tr>
</tbody></table>

<h2 id="delete-cron-job">Delete cron job</h2>
<pre class="highlight shell"><code>curl -X DELETE https://api.cronally.com/cronjob/&lt;cronjob_id&gt;/
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34f10c9d-ca04-4faf-9e83-92eea9e58be8"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cronjob_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"37e545bd-fc2d-43e4-9b4a-e5eb4bc1f54e"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cronjob"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0 * * * *"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint deletes a cron job</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE https://api.cronally.com/cronjob/&lt;cronjob_id&gt;/</code></p>

<h3 id="http-response">HTTP Response</h3>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Status</td>
<td>Success or error</td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<p>The Cronally API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; API key is wrong, invalid signature, etc.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access an endpoint with an invalid method</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
